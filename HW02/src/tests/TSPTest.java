package tests;

import org.junit.Test;
import tsp.TSP;

import static org.junit.Assert.assertEquals;

public class TSPTest {

    private static final int[][] MATRIX_SMALL = {
            {0, 128, 71, 85, 185, 68, 257},
            {128, 0, 91, 62, 58, 81, 161},
            {71, 91, 0, 29, 149, 87, 252},
            {85, 62, 29, 0, 120, 70, 223},
            {185, 58, 149, 120, 0, 117, 107},
            {68, 81, 87, 70, 117, 0, 189},
            {257, 161, 252, 223, 107, 189, 0}
    };

    private static final int[][] MATRIX_MEDIUM = {
            {0, 128, 71, 85, 185, 68, 257, 232, 193, 199},
            {128, 0, 91, 62, 58, 81, 161, 108, 151, 97},
            {71, 91, 0, 29, 149, 87, 252, 199, 212, 143},
            {85, 62, 29, 0, 120, 70, 223, 170, 195, 114},
            {185, 58, 149, 120, 0, 117, 107, 50, 98, 85},
            {68, 81, 87, 70, 117, 0, 189, 164, 126, 178},
            {257, 161, 252, 223, 107, 189, 0, 48, 99, 129},
            {232, 108, 199, 170, 50, 164, 48, 0, 148, 84},
            {193, 151, 212, 195, 98, 126, 99, 148, 0, 183},
            {199, 97, 143, 114, 85, 178, 129, 84, 183, 0}
    };

    private static final int[][] MATRIX_MEDIUM_LARGE = {
            {0, 128, 71, 85, 185, 68, 257, 232, 193, 199, 25, 130, 65},
            {128, 0, 91, 62, 58, 81, 161, 108, 151, 97, 126, 48, 179},
            {71, 91, 0, 29, 149, 87, 252, 199, 212, 143, 89, 149, 136},
            {85, 62, 29, 0, 120, 70, 223, 170, 195, 114, 89, 110, 143},
            {185, 58, 149, 120, 0, 117, 107, 50, 98, 85, 165, 56, 215},
            {68, 81, 87, 70, 117, 0, 189, 164, 126, 178, 48, 62, 98},
            {257, 161, 252, 223, 107, 189, 0, 48, 99, 129, 237, 128, 287},
            {232, 108, 199, 170, 50, 164, 48, 0, 148, 84, 212, 106, 262},
            {193, 151, 212, 195, 98, 126, 99, 148, 0, 183, 174, 101, 223},
            {199, 97, 143, 114, 85, 178, 129, 84, 183, 0, 203, 130, 257},
            {25, 126, 89, 89, 165, 48, 237, 212, 174, 203, 0, 107, 54},
            {130, 48, 149, 110, 56, 62, 128, 106, 101, 130, 107, 0, 160},
            {65, 179, 136, 143, 215, 98, 287, 262, 223, 257, 54, 160, 0}
    };

    private static final int[][] MATRIX_LARGE = {
            {0, 128, 71, 85, 185, 68, 257, 232, 193, 199, 25, 130, 65, 171, 44},
            {128, 0, 91, 62, 58, 81, 161, 108, 151, 97, 126, 48, 179, 72, 84},
            {71, 91, 0, 29, 149, 87, 252, 199, 212, 143, 89, 149, 136, 163, 47},
            {85, 62, 29, 0, 120, 70, 223, 170, 195, 114, 89, 110, 143, 134, 47},
            {185, 58, 149, 120, 0, 117, 107, 50, 98, 85, 165, 56, 215, 14, 142},
            {68, 81, 87, 70, 117, 0, 189, 164, 126, 178, 48, 62, 98, 103, 42},
            {257, 161, 252, 223, 107, 189, 0, 48, 99, 129, 237, 128, 287, 93, 231},
            {232, 108, 199, 170, 50, 164, 48, 0, 148, 84, 212, 106, 262, 64, 192},
            {193, 151, 212, 195, 98, 126, 99, 148, 0, 183, 174, 101, 223, 84, 167},
            {199, 97, 143, 114, 85, 178, 129, 84, 183, 0, 203, 130, 257, 99, 161},
            {25, 126, 89, 89, 165, 48, 237, 212, 174, 203, 0, 107, 54, 151, 42},
            {130, 48, 149, 110, 56, 62, 128, 106, 101, 130, 107, 0, 160, 42, 92},
            {65, 179, 136, 143, 215, 98, 287, 262, 223, 257, 54, 160, 0, 201, 109},
            {171, 72, 163, 134, 14, 103, 93, 64, 84, 99, 151, 42, 201, 0, 145},
            {44, 84, 47, 47, 142, 42, 231, 192, 167, 161, 42, 92, 109, 145, 0}
    };

    static int[][] MATRIX_EXTRA_LARGE = {
            {0, 128, 71, 85, 185, 68, 257, 232, 193, 199, 25, 130, 65, 171, 44, 252, 132, 344, 351, 214},
            {128, 0, 91, 62, 58, 81, 161, 108, 151, 97, 126, 48, 179, 72, 84, 265, 123, 233, 249, 207},
            {71, 91, 0, 29, 149, 87, 252, 199, 212, 143, 89, 149, 136, 163, 47, 271, 149, 288, 295, 233},
            {85, 62, 29, 0, 120, 70, 223, 170, 195, 114, 89, 110, 143, 134, 47, 254, 132, 259, 266, 216},
            {185, 58, 149, 120, 0, 117, 107, 50, 98, 85, 165, 56, 215, 14, 142, 214, 123, 175, 237, 160},
            {68, 81, 87, 70, 117, 0, 189, 164, 126, 178, 48, 62, 98, 103, 42, 184, 62, 292, 330, 146},
            {257, 161, 252, 223, 107, 189, 0, 48, 99, 129, 237, 128, 287, 93, 231, 213, 173, 135, 216, 158},
            {232, 108, 199, 170, 50, 164, 48, 0, 148, 84, 212, 106, 262, 64, 192, 264, 173, 125, 184, 210},
            {193, 151, 212, 195, 98, 126, 99, 148, 0, 183, 174, 101, 223, 84, 167, 116, 74, 234, 315, 62},
            {199, 97, 143, 114, 85, 178, 129, 84, 183, 0, 203, 130, 257, 99, 161, 299, 203, 145, 152, 245},
            {25, 126, 89, 89, 165, 48, 237, 212, 174, 203, 0, 107, 54, 151, 42, 229, 107, 340, 355, 191},
            {130, 48, 149, 110, 56, 62, 128, 106, 101, 130, 107, 0, 160, 42, 92, 192, 70, 231, 293, 152},
            {65, 179, 136, 143, 215, 98, 287, 262, 223, 257, 54, 160, 0, 201, 109, 282, 160, 402, 409, 244},
            {171, 72, 163, 134, 14, 103, 93, 64, 84, 99, 151, 42, 201, 0, 145, 200, 112, 189, 248, 146},
            {44, 84, 47, 47, 142, 42, 231, 192, 167, 161, 42, 92, 109, 145, 0, 226, 104, 306, 313, 188},
            {252, 265, 271, 254, 214, 184, 213, 264, 116, 299, 229, 192, 282, 200, 226, 0, 122, 348, 429, 58},
            {132, 123, 149, 132, 123, 62, 173, 173, 74, 203, 107, 70, 160, 112, 104, 122, 0, 303, 357, 84},
            {344, 233, 288, 259, 175, 292, 135, 125, 234, 145, 340, 231, 402, 189, 306, 348, 303, 0, 189, 293},
            {351, 249, 295, 266, 237, 330, 216, 184, 315, 152, 355, 293, 409, 248, 313, 429, 357, 189, 0, 374},
            {214, 207, 233, 216, 160, 146, 158, 210, 62, 245, 191, 152, 244, 146, 188, 58, 84, 293, 374, 0}
    };


    @Test
    public void testDfsOneCity() throws Exception {
        int[][] cities = {{0}};
        int res[] = TSP.dfs(cities);
        assertEquals(2, res.length);
    }

    @Test
    public void testBfsOneCity() throws Exception {
        int[][] cities = {{0}};
        int res[] = TSP.bfs(cities);
        assertEquals(2, res.length);
    }

    @Test
    public void testDfsSmall() throws Exception {
        int res[] = TSP.dfs(MATRIX_SMALL);
        int len = getLen(res, MATRIX_SMALL);

        assertEquals(584, len);
    }

    @Test
    public void testBfsSmall() throws Exception {
        int res[] = TSP.bfs(MATRIX_SMALL);
        int len = getLen(res, MATRIX_SMALL);

        assertEquals(584, len);
    }

    private int getLen(int[] res, int[][] matrix) {
        int len = 0;
        for (int i = 0; i < res.length - 1; i++) {
            len += matrix[res[i]][res[i + 1]];
        }
        return len;
    }


    @Test
    public void testDfsMedium() throws Exception {
        int res[] = TSP.dfs(MATRIX_MEDIUM);
        int len = getLen(res, MATRIX_MEDIUM);
        assertEquals(730, len);
    }


    @Test
    public void testBfsMedium() throws Exception {
        int res[] = TSP.bfs(MATRIX_MEDIUM);
        int len = getLen(res, MATRIX_MEDIUM);
        assertEquals(730, len);
    }

    @Test
    public void testDfsMediumLargeBranchAndBound() throws Exception {
        int res[] = TSP.dfs(MATRIX_MEDIUM_LARGE);
        int len = getLen(res, MATRIX_MEDIUM_LARGE);
        assertEquals(866, len);
    }

    @Test
    public void testBfsMediumLargeBranchAndBound() throws Exception {
        int res[] = TSP.bfs(MATRIX_MEDIUM_LARGE);
        int len = getLen(res, MATRIX_MEDIUM_LARGE);
        assertEquals(866, len);
    }

    @Test
    public void testDfsLargeBranchAndBound() throws Exception {
        int res[] = TSP.dfs(MATRIX_LARGE);
        int len = getLen(res, MATRIX_LARGE);
        assertEquals(893, len);
    }

    @Test
    public void testBfsLarge() throws Exception {
        int res[] = TSP.bfs(MATRIX_LARGE);
        int len = getLen(res, MATRIX_LARGE);
        assertEquals(893, len);
    }

}